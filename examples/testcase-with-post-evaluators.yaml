# youBencha Test Case with Post-Evaluators
# Demonstrates exporting results to external systems

name: "Add welcome message with results export"
description: "Tests the agent's ability to add a friendly welcome message and exports results to multiple systems"

# Repository configuration
repo: https://github.com/octocat/Hello-World.git
branch: master

# Agent configuration
agent:
  type: copilot-cli
  config:
    prompt: "Add a friendly welcome message to the README file"

# Evaluators
evaluators:
  - name: git-diff
  - name: agentic-judge
    config:
      type: copilot-cli
      agent_name: agentic-judge
      assertions:
        readme_was_modified: "The README.md file was modified. Score 1 if true, 0 if false."
        message_is_friendly: "A friendly welcome message was added. Score 1 if friendly, 0.5 if neutral, 0 if absent."

# Post-evaluators - run after evaluation completes
post_evaluators:
  # Export to JSON Lines file for historical tracking
  - name: database
    config:
      type: json-file
      output_path: ./results-history.jsonl
      include_full_bundle: true
      append: true

  # Post to webhook (example - requires WEBHOOK_URL env var)
  # - name: webhook
  #   config:
  #     url: https://api.example.com/youbencha/results
  #     method: POST
  #     headers:
  #       Authorization: "Bearer ${WEBHOOK_TOKEN}"
  #       Content-Type: "application/json"
  #     include_artifacts: false
  #     retry_on_failure: true
  #     timeout_ms: 5000

  # Run custom script (example)
  # - name: script
  #   config:
  #     command: ./scripts/analyze-results.sh
  #     args:
  #       - "--results"
  #       - "${RESULTS_PATH}"
  #     env:
  #       NOTIFY_ON_FAILURE: "true"
  #     timeout_ms: 30000
